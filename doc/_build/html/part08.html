
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Visualisierung von Messwerten und lineare Regression &#8212; MATLAB für Studierende der Ingenieurwissenschaften</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Einführung und Lernziele" href="part07.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/book_matlab_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">MATLAB für Studierende der Ingenieurwissenschaften</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Willkommen zum Lernkurs MATLAB für Studierende der Ingenieurwissenschaften
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Programmierung
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="part01.html">
   1. Einstieg in die Programmierung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="part02.html">
   2. Programmverzweigung (if - elseif - else)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="part03.html">
   3. Digitale Logik und Schleifen mit Bedingungen (while)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="part04.html">
   4. Array, String und formatierte Ausgaben (fprintf)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="part05.html">
   5. Schleifen zum Zählen (for)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="part06.html">
   6. Funktionen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="part07.html">
   7. Datenvisualisierung
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   8. Regression
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/part08.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/gramschs/book_matlab"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/gramschs/book_matlab/master?urlpath=tree/docs/part08.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-von-messdaten">
   Import von Messdaten
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-ein-wenig-theorie">
   Regression - ein wenig Theorie
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-mit-matlab-polyfit">
   Regression mit MATLAB: polyfit
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Visualisierung von Messwerten und lineare Regression</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-von-messdaten">
   Import von Messdaten
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-ein-wenig-theorie">
   Regression - ein wenig Theorie
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#regression-mit-matlab-polyfit">
   Regression mit MATLAB: polyfit
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="visualisierung-von-messwerten-und-lineare-regression">
<h1>Visualisierung von Messwerten und lineare Regression<a class="headerlink" href="#visualisierung-von-messwerten-und-lineare-regression" title="Permalink to this headline">¶</a></h1>
<p>Nachdem wir uns mit Datenvisualisierung beschäftigt haben, werden wir in diesem Vorlesungsskript das Gelernte auf Messdaten anwenden. Dazu erarbeiten wir uns, wie MATLAB Messdaten importiert und verarbeitet werden. Darüber hinaus versuchen wir, in den Messdaten Muster zu finden, oder mathematisch ausgedrückt, an die Messdaten ein Regressionspolynom anzupassen.</p>
<div class="section" id="import-von-messdaten">
<h2>Import von Messdaten<a class="headerlink" href="#import-von-messdaten" title="Permalink to this headline">¶</a></h2>
<p>Messwerte werden normalerweise nicht händisch in ein MATLAB Live Script eingegeben. Meist werden Daten durch einen Sensor in eine Textdatei gespeichert oder in einer Excel-Datei erfasst. In der Wissenschaft ist es üblich, Messdaten im csv-Format abzuspeichern. Dabei steht <strong>csv</strong> für <strong>comma separated values</strong>, d.h. in einer Textdatei wird pro Messung eine Zeile verwendet und alle Daten pro Messung werden in diese Zeile durch Komma getrennt geschrieben.</p>
<p>In einer  csv-Datei können auch Kommentare stehen. Das ist beispielsweise sinnvoll, um die Quelle der Daten zu notieren. MATLAB interpretiert die ersten Zeile nach eventuellen Kommentaren als Spaltenüberschriften, wenn beim Import dort Strings vorgefunden werden. Dabei dürfen keine Leerzeichen oder Umlaute in den Strings vorkommen, sonst gibt es eine Fehlermeldung und MATLAB konvertiert die Spaltenüberschriften eigenmächtig.</p>
<p>Im Folgenden betrachten wir uns den weltweiten CO2-Ausstoß bis 2020 in metrischen Tonnen pro Einwohner (Quelle: <a class="reference external" href="https://data.worldbank.org/indicator/EN.ATM.CO2E.PC">https://data.worldbank.org</a>.</p>
<p>Die ersten Zeilen der csv-Datei sehen so aus:</p>
<p>Jahr,“Metrische_Tonnen_pro_Einwohner”</p>
<p>1990,3.90295218998934</p>
<p>1991,3.87459045104576</p>
<p>1992,3.80401065140913</p>
<p>1993,3.76932773275631</p>
<p>1994,3.73238510585118</p>
<p>1995,3.78198265021746</p>
<p>…</p>
<p>Als nächstes laden wir unsere Messdaten in den Speicher.</p>
<p>Der Befehl zum Lesen einer csv-Datei lautet (für mehr Informationen siehe <a class="reference external" href="https://de.mathworks.com/help/matlab/ref/readtable.html">MATLAB-Dokumentation</a>:</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">=</span><span class="nb">readtable</span><span class="p">(</span><span class="s">&#39;dateiname.csv&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>Meistens werden die Daten mit einem Komma <code class="docutils literal notranslate"><span class="pre">,</span></code> getrennt, manchmal - vor allem im deutschsprachigen Raum - auch mit einem Semikolon <code class="docutils literal notranslate"><span class="pre">;</span></code>. Durch Angabe des Separators, also dem Trennzeichen, können wir direkt beim Einlesen schon das richtige einstellen, für viele deutschsprachige Dokumente also</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">readtable</span><span class="p">(</span><span class="n">dateiname</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Delimiter&#39;</span><span class="p">,</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;decimal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;,&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<p>mit dem Komma als Dezimaltrennzeichen und nicht als Trennzeichen zwischen Spalten.</p>
<p>Die Daten in der csv sind aber bereits wie üblich formatiert, so dass wir die CO2-Emissionen direkt ohne optionale Parameter laden können. Die Zeile mit dem Kommentarzeichen wird dabei übersprungen.</p>
<p>Wir gehen davon aus, dass die Datei in einem Verzeichnis namens data liegt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">readtable</span><span class="p">(</span><span class="s">&#39;data/co2_emissionen_worldwide.csv&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data =

  29x2 table
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Jahr    Metrische_Tonnen_pro_Einwohner
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ____    ______________________________
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1990                 3.903            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1991                3.8746            
    1992                 3.804            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1993                3.7693            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1994                3.7324            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1995                 3.782            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1996                3.8067            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1997                3.8135            
    1998                3.7806            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    1999                3.7478            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2000                3.8127            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2001                3.8277            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2002                3.8348            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2003                3.9585            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2004                4.0923            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2005                4.1963            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2006                 4.281            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2007                4.3919            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2008                4.3769            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2009                4.2771            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2010                4.4832            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2011                4.5695            
    2012                4.5765            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2013                4.6065            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2014                 4.556            
    2015                4.4835            
    2016                4.4313            
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    2017                4.4355            
    2018                4.4777            
</pre></div>
</div>
</div>
</div>
<p>Wir können direkt auf die Tabelleninhalte zugreifen, wenn wir geschweifte Klammern benutzen. Mit dem Doppelpunkt-Operator <code class="docutils literal notranslate"><span class="pre">:</span></code> und dem Spaltennamen schneiden wir die komplette Spalte aus der Tabelle heraus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="s">&#39;Jahr&#39;</span><span class="p">};</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="s">&#39;Metrische_Tonnen_pro_Einwohner&#39;</span><span class="p">};</span><span class="w"></span>

<span class="nb">disp</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="nb">disp</span><span class="p">(</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        1990
        1991
        1992
        1993
        1994
        1995
        1996
        1997
        1998
        1999
        2000
        2001
        2002
        2003
        2004
        2005
        2006
        2007
        2008
        2009
        2010
        2011
        2012
        2013
        2014
        2015
        2016
        2017
        2018
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    3.9030
    3.8746
    3.8040
    3.7693
    3.7324
    3.7820
    3.8067
    3.8135
    3.7806
    3.7478
    3.8127
    3.8277
    3.8348
    3.9585
    4.0923
    4.1963
    4.2810
    4.3919
    4.3769
    4.2771
    4.4832
    4.5695
    4.5765
    4.6065
    4.5560
    4.4835
    4.4313
    4.4355
    4.4777
</pre></div>
</div>
</div>
</div>
<div class="exercise admonition" id="exercise_08_01">

<p class="admonition-title"><span class="caption-number">Exercise 55 </span></p>
<div class="section" id="exercise-content">
<p>Speichern Sie nur die Messungen der Jahre 2010 bis 2020 in einem x- und einem y-Array.</p>
</div>
</div>
<div class="solution dropdown admonition" id="solution_08_01">

<p class="admonition-title">Solution to<a class="reference internal" href="#exercise_08_01"> Exercise 55</a></p>
<div class="section" id="solution-content">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{</span><span class="mi">11</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="s">&#39;Jahr&#39;</span><span class="p">};</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{</span><span class="mi">11</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="s">&#39;Metrische_Tonnen_pro_Einwohner&#39;</span><span class="p">};</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Sobald die Messdaten in einem normalen MATLAB-Array vorliegen, können wir sie wie gewohnt weiterverarbeiten. Als erstes visualisieren wir die Messdaten und nehmen dazu ein Streudiagramm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">figure</span><span class="p">();</span><span class="w"></span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Jahr&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Metrische Tonnen pro Einwohner&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Weltweiter CO2-Ausstoß von 1990 bis 2018&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/part08_8_0.png" src="_images/part08_8_0.png" />
</div>
</div>
<div class="exercise admonition" id="exercise_08_02">

<p class="admonition-title"><span class="caption-number">Exercise 56 </span></p>
<div class="section" id="exercise-content">
<p>Importieren Sie den Datensatz zur Bundesligasaison 2020/21 von Bayern München (Dateiname ‘bayern_muenchen_2020.csv’). Visualisieren Sie, wie viele Minuten jeder Spieler in dieser Saison auf dem Platz gestanden hat (x ist die Spalte ‘Name’, y die Spalte ‘Mins’ ).</p>
<ul class="simple">
<li><p>Welches Diagramm passt am besten, Linien-, Balken- oder Streudiagramm?</p></li>
<li><p>Welcher Spieler hatte die meiste Spielzeit?</p></li>
</ul>
</div>
</div>
<div class="solution dropdown admonition" id="solution_08_02">

<p class="admonition-title">Solution to<a class="reference internal" href="#exercise_08_02"> Exercise 56</a></p>
<div class="section" id="solution-content">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Import Messdaten</span><span class="w"></span>
<span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">readtable</span><span class="p">(</span><span class="s">&#39;bayern_muenchen_2020.csv&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">categorical</span><span class="p">(</span><span class="n">data</span><span class="p">{:,</span><span class="s">&#39;Name&#39;</span><span class="p">});</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="s">&#39;Mins&#39;</span><span class="p">};</span><span class="w"></span>

<span class="c">% Datenvisualisierung</span><span class="w"></span>
<span class="nb">figure</span><span class="p">();</span><span class="w"></span>
<span class="nb">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Spieler&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Minuten&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Bundesligasaison 2020/21&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="regression-ein-wenig-theorie">
<h2>Regression - ein wenig Theorie<a class="headerlink" href="#regression-ein-wenig-theorie" title="Permalink to this headline">¶</a></h2>
<p>Kehren wir zu unserem Beispiel mit dem weltweiten CO2-Austoß zurück. Bisher haben wir nur die Messwerte visualisiert. Wenn wir jetzt eine Prognose für das Jahr 2030 wagen wollen, brauchen wir ein Modell. Lassen wir CO2-Emissionen noch einmal zeichnen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Import Messdaten</span><span class="w"></span>
<span class="n">data</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">readtable</span><span class="p">(</span><span class="s">&#39;data/co2_emissionen_worldwide.csv&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>

<span class="c">% Datenvisualisierung</span><span class="w"></span>
<span class="nb">figure</span><span class="p">();</span><span class="w"></span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;filled&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Jahr&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Metrische Tonnen pro Einwohner&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">grid</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Weltweiter CO2-Ausstoß von 1990 bis 2018&#39;</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/part08_11_0.png" src="_images/part08_11_0.png" />
</div>
</div>
<p>Fangen wir mit dem einfachsten Modell an, diese Messdaten zu beschreiben, mit einer linearen Funktion.
In der Statistik beschäftigen sich Mathematikerinnen und Mathematiker bereits seit Jahrhunderten damit, Analyseverfahren zu entwickeln, mit denen experimentelle Daten gut erklärt werden können. Falls wir eine “erklärende” Variable (hier das Jahr) haben und wir versuchen, die Abhängigkeit einer Messgröße (hier die CO2-Emissionen pro Einwohner) von der erklärenden Variable zu beschreiben, nennen wir das <strong>Regressionsanalyse</strong> oder kurz <strong>Regression</strong>. Bei vielen Problemen suchen wir nach einem linearen Zusammenhang und sprechen daher von linearer Regression. Mehr Details finden Sie auch bei <a class="reference external" href="https://de.wikipedia.org/wiki/Regressionsanalyse">Wikipedia (Regressionsanalyse)</a>.</p>
<div class="exercise admonition" id="exercise_08_03">

<p class="admonition-title"><span class="caption-number">Exercise 57 </span></p>
<div class="section" id="exercise-content">
<p>Denken Sie sich Werte für die Steigung m und den y-Achsenabschnitt b einer linearen Funktion  aus. Erzeugen Sie einen Vektor mit 100 x-Werten von 1990 bis 2018 und einen Vektor y mit <span class="math notranslate nohighlight">\(y=mx+b\)</span>. Lassen Sie diese lineare Funktion als durchgezogene rote Linie in den gleichen Plot wie die gepunkteten Messwerte zeichnen. Welche Werte für m und b müssen Sie wählen, damit die rote Linie passend zu den blauen Punkten ist? Spielen Sie mit m und b herum, bis es passen könnte.</p>
</div>
</div>
<div class="solution dropdown admonition" id="solution_08_03">

<p class="admonition-title">Solution to<a class="reference internal" href="#exercise_08_03"> Exercise 57</a></p>
<div class="section" id="solution-content">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">x_modell</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="mi">1990</span><span class="p">,</span><span class="w"> </span><span class="mi">2018</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span><span class="w"></span>

<span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.0344</span><span class="p">;</span><span class="w"></span>
<span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mf">64.7516</span><span class="p">;</span><span class="w"></span>
<span class="n">y_modell</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x_modell</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>

<span class="nb">figure</span><span class="p">();</span><span class="w"></span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x_modell</span><span class="p">,</span><span class="w"> </span><span class="n">y_modell</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;r-&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Jahr&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Metrische Tonnen pro Einwohner&#39;</span><span class="p">);</span><span class="w"></span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Weltweiter CO2-Ausstoß von 1990 bis 2018&#39;</span><span class="p">);</span><span class="w"> </span>
</pre></div>
</div>
</div>
</div>
<p>Wenn wir jetzt eine Prognose für das Jahr 2030 wagen wollen, können wir den Wert  in die lineare Funktion einsetzen und erhalten für 2030 einen CO2-Ausstoß von 5.1 metrischen Tonnen pro Einwohner :-(</p>
<p>Woher wissen wir eigentlich, dass diese Steigung <span class="math notranslate nohighlight">\(m\)</span> und dieser y-Achsenabschnitt <span class="math notranslate nohighlight">\(b\)</span> am besten passen? Dazu berechnen wir, wie weit weg die Gerade von den Messpunkten ist. Wie das geht, veranschaulichen wir uns mit der folgenden Grafik.</p>
<div class="figure align-default" id="part08-regression">
<a class="reference internal image-reference" href="_images/part08_regression.png"><img alt="_images/part08_regression.png" src="_images/part08_regression.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Messpunkte (blau) und der Abstand (grün) zu einer Modellfunktion (rot)</span><a class="headerlink" href="#part08-regression" title="Permalink to this image">¶</a></p>
<div class="legend">
<p>(<a class="reference external" href="https://de.wikipedia.org/wiki/Methode_der_kleinsten_Quadrate#/media/Datei:MDKQ1.svg">Quelle:</a> Autor: Christian Schirm, Lizenz: CC0)</p>
</div>
</div>
<p>Unsere rote Modellfunktion trifft die Messpunkte mal mehr und mal weniger gut. Wir können jetzt für jeden Messpunkt berechnen, wie weit die rote Kurve von ihm weg ist (= grüne Strecke), indem wir die Differenz der y-Koordinaten errechnen: <span class="math notranslate nohighlight">\(r = y_{\text{blau}}-y_{\text{rot}}\)</span>. Diese Differenz nennt man <strong>Residuum</strong>. Danach summieren wir die Fehler (also die Residuen) auf und erhalten den Gesamtfehler. Leider kann es dabei passieren, dass am Ende als Gesamtfehler 0 herauskommt, weil beispielsweise für den 1. Messpunkt die blaue y-Koordinate unter der roten y-Koordinate liegt und damit ein negatives Residuum herauskommt, aber für den 5. Messpunkt ein positives Residuum. Daher quadrieren wir die Residuen. Und damit nicht der Gesamtfehler größer wird nur, weil wir mehr Messpunkte dazunehmen, teilen wir noch durch die Anzahl der Messpunkte <span class="math notranslate nohighlight">\(N\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% blaue y-Koordinaten = Messpunkte</span><span class="w"></span>
<span class="n">y_blau</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="mi">2</span><span class="p">};</span><span class="w"></span>

<span class="c">% Berechnung der roten y-Koordinaten, indem wir x-Koordinaten der Messpunkte</span><span class="w"></span>
<span class="c">% in die Modellfunktion y = m*x + b einsetzen</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">data</span><span class="p">{:,</span><span class="mi">1</span><span class="p">};</span><span class="w"></span>
<span class="n">y_rot</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.0344</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">64.7516</span><span class="p">;</span><span class="w"></span>

<span class="c">% Berechnung Gesamtfehler</span><span class="w"></span>
<span class="n">N</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">size</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="n">gesamtfehler</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">y_blau</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_rot</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;Der Gesamtfehler ist %g.&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">gesamtfehler</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Der Gesamtfehler ist 0.0224891.
</pre></div>
</div>
</div>
</div>
<p>Ist das jetzt groß oder klein? Liegt eine gute Modellfunktion vor, die die Daten gut nähert oder nicht? Um das zu beurteilen, berechnen wir wie groß der Fehler wäre, wenn wir nicht die roten y-Koordinaten der Modellfunktion in die Fehlerformel einsetzen, sondern einfach nur den Mittelwert als Schätzwert. Dafür stellt uns MATLAB die Funktion <code class="docutils literal notranslate"><span class="pre">mean()</span></code> zur Verfügung:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">y_mittelwert</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">mean</span><span class="p">(</span><span class="n">y_blau</span><span class="p">);</span><span class="w"></span>
<span class="n">gesamtfehler_mittelwert</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">y_blau</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_mittelwert</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;Der Gesamtfehler für den Mittelwert als Schätzung ist %g.&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">gesamtfehler_mittelwert</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Der Gesamtfehler für den Mittelwert als Schätzung ist 0.101701.
</pre></div>
</div>
</div>
</div>
<p>Offensichtlich ist der Gesamtfehler für die Modellfunktion kleiner als wenn wir einfach nur immer den Mittelwert prognostizieren würden. Wir rechnen das in Prozent um:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">relativer_fehler</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">gesamtfehler</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">gesamtfehler_mittelwert</span><span class="p">;</span><span class="w"></span>

<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;Der relative Fehler der Modellfunktion im Verhältnis zum Fehler beim Mittelwert ist: %.4f&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">relativer_fehler</span><span class="p">);</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;In Prozent umgerechnet ist das: %.2f %%.&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">relativer_fehler</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Der relative Fehler der Modellfunktion im Verhältnis zum Fehler beim Mittelwert ist: 0.2211
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>In Prozent umgerechnet ist das: 22.11 %.
</pre></div>
</div>
</div>
</div>
<p>In der Statistik wurde diese Verhältnis (Gesamtfehler geteilt durch Gesamtfehler Mittelwert) als Qualitätkriterium für ein lineares Regressionsproblem festgelegt. Genaugenommen, rechnet man 1 - Gesamtfehler /  (Gesamtfehler Mittelwert) und nennt diese Zahl Bestimmtheitsmaß <span class="math notranslate nohighlight">\(R^2\)</span>. Details finden Sie bei <a class="reference external" href="https://de.wikipedia.org/wiki/Bestimmtheitsma%C3%9F">Wikipedia (Bestimmtheitsmaß)</a>. Die Formel lautet:</p>
<div class="math notranslate nohighlight">
\[R^2 = 1 - \frac{\sum_{i=1}^N (y_i - f(x_i))^2}{\sum_{i=1}^N(y_i-\bar{y})}. \]</div>
<p>Dabei kürzt sich das <span class="math notranslate nohighlight">\(\frac{1}{N}\)</span> im Zähler und Nenner weg.
Nachdem der <span class="math notranslate nohighlight">\(R^2\)</span>-Wert ausgerechnet wurde, können wir nun die Qualität der Anpassung beurteilen:</p>
<ul class="simple">
<li><p>Wenn <span class="math notranslate nohighlight">\(R^2 = 1\)</span>  ist, dann gibt es den perfekten linearen Zusammenhang und die Modellfunktion ist eine sehr gute Anpassung an die Messdaten.</p></li>
<li><p>Wenn <span class="math notranslate nohighlight">\(R^2 = 0\)</span> oder gar negativ ist, dann funktioniert die lineare Modellfunktion überhaupt nicht.</p></li>
</ul>
</div>
<div class="section" id="regression-mit-matlab-polyfit">
<h2>Regression mit MATLAB: polyfit<a class="headerlink" href="#regression-mit-matlab-polyfit" title="Permalink to this headline">¶</a></h2>
<p>MATLAB unterstützt die Suche nach der Regressionspolynomen mit der Funktion <code class="docutils literal notranslate"><span class="pre">polyfit()</span></code>. Eine detaillierte Bechreibung finden Sieìn der <a class="reference external" href="https://de.mathworks.com/help/matlab/ref/polyfit.html">MATLAB-Dokumentation (polyfit)</a>. Aufgerufen wird polyfit mit</p>
<p><code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">polyfit(x,y,n)</span></code></p>
<p>Dabei sind x und y die Arrays (Vektoren) der Messdaten und n ist der Polynomgrad. Für eine lineare Funktion setzen wir n = 1. Das Ergebnis ist ein Vektor p. Im ersten Eintrag des Vektors steht die Steigung, im zweiten der y-Achsenabschnitt.
Wenn wir einen höheren Polynomgrad verwenden, dann gibt uns p die Koeffizienten des Polynoms absteigend, also p(1) den Koeffizienten der höchsten Potenz, p(2) den Koeffizienten der zweithöchsten Potenz usw. bis p(n).</p>
<p>Wir visualisieren zunächst die folgenden sieben Messpunkte:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">  </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">];</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">5.4384</span><span class="p">,</span><span class="w"> </span><span class="mf">14.3252</span><span class="p">,</span><span class="w"> </span><span class="mf">19.2451</span><span class="p">,</span><span class="w"> </span><span class="mf">23.3703</span><span class="p">,</span><span class="w"> </span><span class="mf">18.2885</span><span class="p">,</span><span class="w"> </span><span class="mf">13.8978</span><span class="p">,</span><span class="w"> </span><span class="mf">3.7586</span><span class="p">];</span><span class="w"></span>

<span class="nb">figure</span><span class="p">();</span><span class="w"></span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;filled&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/part08_24_0.png" src="_images/part08_24_0.png" />
</div>
</div>
<p>Sieht nicht nach einer linearen Funktion, also einer Geraden aus. Wir probieren es mit einer quadratischen Funktion. Die Modellfunktion lautet <span class="math notranslate nohighlight">\(f(x)=ax^2bx+c\)</span> mit den Parametern <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>  und <span class="math notranslate nohighlight">\(c\)</span>.
Wir setzen in der <code class="docutils literal notranslate"><span class="pre">polyfit()</span></code>-Funktion den Polynomgrad auf <span class="math notranslate nohighlight">\(n=2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Jetzt hat der Rückgabewert der <code class="docutils literal notranslate"><span class="pre">polyfit()</span></code>-Funktion drei Werte:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">whos</span><span class="w"> </span><span class="n">p</span><span class="w"></span>
<span class="nb">disp</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Name      Size            Bytes  Class     Attributes

  p         1x3                24  double              

   -2.0021    8.0906   14.7279
</pre></div>
</div>
</div>
</div>
<p>Der 1. Koeffizient -2.0021 ist der Koeffizient für die höchste Potenzfunktion, danach wird absteigend sortiert. Wir erhalten also als Regressionsfunktion</p>
<div class="math notranslate nohighlight">
\[r(x)=-2.0021x^2 + 8.0906x + 14.7279.\]</div>
<p>Visualisieren wir die Modellfunktion zusammen mit den Messpunkten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">figure</span><span class="p">();</span><span class="w"></span>
<span class="nb">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="n">hold</span><span class="w"> </span><span class="s">on</span><span class="p">;</span><span class="w"></span>
<span class="n">x_plot</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">);</span><span class="w"></span>
<span class="n">y_plot</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mf">2.0021</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">x_plot</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.0906</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">x_plot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.7279</span><span class="p">;</span><span class="w"></span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x_plot</span><span class="p">,</span><span class="w"> </span><span class="n">y_plot</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/part08_30_0.png" src="_images/part08_30_0.png" />
</div>
</div>
<p>Sieht eigentlich sehr gut aus. Zuletzt berechnen wir den <span class="math notranslate nohighlight">\(R^2\)</span>-Wert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">y_modell</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mf">2.0021</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">x</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">8.0906</span><span class="w"> </span><span class="o">.*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">14.7279</span><span class="p">;</span><span class="w"></span>
<span class="n">fehler_modell</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_modell</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">y_mittelwert</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">mean</span><span class="p">(</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="n">fehler_mittelwert</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_mittelwert</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="p">);</span><span class="w"></span>

<span class="n">R2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fehler_modell</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">fehler_mittelwert</span><span class="p">;</span><span class="w"></span>
<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;R2-Bestimmtheitsmaß: %.4f&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">R2</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R2-Bestimmtheitsmaß: 0.9450
</pre></div>
</div>
</div>
</div>
<p>Der gute visuelle Eindruck bestätigt sich, das Regressionsmodell ist sehr gut.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "matlab"
        },
        kernelOptions: {
            kernelName: "matlab",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'matlab'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="part07.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Einführung und Lernziele</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Simone Gramsch<br/>
    
        &copy; Copyright 2022.<br/>
      <div class="extra_footer">
        <div>
<a href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img class="license" alt="Creative Commons License" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a> This book is licensed under a <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a>.
</div>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>